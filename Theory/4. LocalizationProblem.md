# Localization problem

After modeling the noise source, it is now time to localize it using a set of sensors located in known positions. This means that an inverse problem must be solved.

## 1. Problem description

Each of the microphones produces a reading in acoustic pressure $p(t)$. The reading is a sum of the signal coming straight from the source, multipath signals reflected by the obstacles and environment noise.

\[p_i(t)=s(t-\tau_i)+\sum_ka_ks(t-\tau_{i,k})+n_i(t)\]

The information connected to the geometry is contained in the time delay between the reception of different sensors. The inverse problem consists in estimating the unknown source position that best explains the set of delayed and attenuated signals measured by the sensor array.
Ideally, without the multipath problem, the position of the source could be determined knowing that if two sensors receive the same signal with a time delay of $\Delta t$, their distance from the source will be different of approximately $\Delta r=c\cdot\Delta t$.
However, multipath makes delay estimation ambiguous and unreliable, so this direct method is not sufficiently robust for this case study.

## 2. Beamforming

A robust solution is to use a technique called beamforming. Beamforming is traditionally introduced as a technique to steer the sensitivity of an array. In this work, however, it is employed in its passive form as a spatial filtering technique applied to a microphone array.
Rather than steering energy toward a given direction, the method evaluates how well a hypothesized source position explains the set of signals recorded by the sensors, based on propagation delays predicted by the forward model. The method is summarized as follows:

1. An initial guess $\hat{\bm{x}}$ on the source position $\bm{x}$ is made.
2. Based on the guessed position, the correspondant delays on each microphone $\tau_i=\dfrac{||\hat{\bm{x}}-\bm{x_i}||}{c}$ is calculated. The beamforming delays are directly derived from the same forward propagation model used to generate the signals, ensuring internal physical consistency between simulation and inversion.
3. Each of the recorded signal $p_i(t)$ is delayed of $\tau_i$ and is summed.
4. The closer $\hat{\bm{x}}$ gets to $\bm{x}$, the more $y=\sum_ip_i(t+\tau_i(\bm{x}))$ produces constructive interference and the peaks are aligned. So, the source position is estimated by scanning a predefined spatial grid and evaluating a cost function related to the constructive interference, for example $J(\bm{x})=\int|y(t,\bm{x})|^2dt$

By integrating information over time and across multiple sensors, beamforming exploits temporal coherence rather than relying on explicit delay estimation. This makes it more robust than pairwise TDOA methods in the presence of noise and multipath propagation.
